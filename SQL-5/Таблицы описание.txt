Есть данные о компании, организующей перевозки грузов. Интересующие нас данные хранятся в таблицах city, customer, driver, shipment, truck. 
Ниже представлена ER-диаграмма, которая отображает существующие связи между отдельными таблицами.

Таблица city — это справочник городов. Структура справочника представлена ниже.

Название поля	Тип данных	Описание
city_id	integer	уникальный идентификатор города, первичный ключ
city_name	text	название города
state	text	штат, к которому относится город
population	integer	население города
area	numeric	площадь города


Таблица customer — это справочник клиентов. Справочник содержит следующие поля:
Название поля	Тип данных	Описание
cust_id	integer	уникальный идентификатор клиента, первичный ключ
cust_name	text	название клиента
annual_revenue	numeric	ежегодная выручка
cust_type	text	тип пользователя
address	text	адрес
zip	integer	почтовый индекс
phone	text	телефон
city_id	integer	идентификатор города, внешний ключ к таблице city


Следующая таблица — driver — справочник водителей. Перечень сведений, содержащихся в таблице, представлен ниже.
Название поля	Тип данных	Описание
driver_id	integer	уникальный идентификатор водителя, первичный ключ
first_name	text	имя водителя
last_name	text	фамилия водителя
address	text	адрес водителя
zip_code	integer	почтовый индекс водителя
phone	text	телефон водителя
city_id	integer	идентификатор города водителя, внешний ключ к таблице city


В таблице truck хранится информация о грузовиках, на которых осуществляются перевозки. Данные о них представлены в следующем виде:
Название поля	Тип данных	Описание
truck_id	integer	Уникальный идентификатор грузовика, первичный ключ
make	 text	Производитель грузовика
model_year	integer	Дата выпуска грузовика

Последняя таблица в датасете, shipment, — таблица с данными непосредственно о доставках. Она описывает взаимодействие всех перечисленных сущностей, а потому содержит наибольшее количество ссылок на другие таблицы.

Название поля	Тип данных	Описание
ship_id	integer	уникальный идентификатор доставки, первичный ключ
cust_id	integer	идентификатор клиента, которому отправлена доставка, внешний ключ к таблице customer
weight	numeric	вес посылки
truck_id	integer	идентификатор грузовика, на котором отправлена доставка, внешний ключ к таблице truck
driver_id	integer	идентификатор водителя, который осуществлял доставку, внешний ключ к таблице driver
city_id	integer	идентификатор города в который совершена доставка, внешний ключ к таблице city
ship_date	date	дата доставки


Представим, что к вам пришёл разработчик, который хочет сократить поле state в таблице city до четырёх символов, и попросил проверить, останeтся ли значения в нём уникальными. Чтобы ответить на этот вопрос, напишите SQL-запрос, который выведет первые четыре символа названия штата и количество уникальных названий штатов, которому они соответствуют. Оставьте только те, которые относятся к двум и более штатам. Добавьте сортировку по первому столбцу. Столбцы в выдаче: code (четыре первых символа в названии штата), qty (количество уникальных названий штата, начинающихся с этих символов).


Составим справочник названий клиентов, у которых более десяти доставок. Данные сохраним в нижнем регистре, чтобы передавать их в другие системы (например, для обзвона), которые не чувствительны к регистру. Напишите SQL запрос, который выводит все id названий клиентов, у которых более десяти доставок, в нижнем регистре. Отсортируйте результат по cust_id в порядке возрастания. Столбцы в выдаче: cust_id (id клиента) и cust_name (название клиента в нижнем регистре).


Напишите SQL запрос, который выводит два столбца: city_name и shippings_fake. Выведите города, куда совершались доставки. Пусть первый столбец содержит название города, а второй формируется так:

если в городе было более десяти доставок, вывести количество доставок в этот город как есть;
иначе — вывести количество доставок, увеличенное на пять.
Отсортируйте по убыванию получившегося «нечестного» количества доставок, а затем — по имени в алфавитном порядке.


Напишите SQL запрос, который создает уникальный алфавитный справочник всех городов, штатов, имён водителей и производителей грузовиков. Результатом запроса должны быть два столбца: название и тип объекта (city, state, driver, truck). Отсортируйте список по названию объекта, а затем — по типу.

