# Проект: Прогнозирование рейтинга отелей на основе отзывов

## Описание проекта

Этот проект направлен на прогнозирование рейтинга отелей на основе отзывов, оставленных пользователями на сайте Booking.com. Датасет содержит информацию о 515,000 отзывов на отели в Европе, включая такие данные, как адрес отеля, дата отзыва, текст отзыва, оценка отеля и другие характеристики. Основная задача — построить модель, которая сможет предсказать рейтинг отеля на основе имеющихся данных.

## Исходные данные

Датасет содержит следующие поля:

- **hotel_address** — адрес отеля.
- **review_date** — дата, когда рецензент разместил соответствующий отзыв.
- **average_score** — средний балл отеля, рассчитанный на основе последнего комментария за последний год.
- **hotel_name** — название отеля.
- **reviewer_nationality** — страна рецензента.
- **negative_review** — отрицательный отзыв, который рецензент дал отелю.
- **review_total_negative_word_counts** — общее количество слов в отрицательном отзыве.
- **positive_review** — положительный отзыв, который рецензент дал отелю.
- **review_total_positive_word_counts** — общее количество слов в положительном отзыве.
- **reviewer_score** — оценка, которую рецензент поставил отелю на основе своего опыта.
- **total_number_of_reviews_reviewer_has_given** — количество отзывов, которые рецензенты дали в прошлом.
- **total_number_of_reviews** — общее количество действительных отзывов об отеле.
- **tags** — теги, которые рецензент дал отелю.
- **days_since_review** — количество дней между датой проверки и датой очистки.
- **additional_number_of_scoring** — количество действительных оценок без проверки.
- **lat** — географическая широта отеля.
- **lng** — географическая долгота отеля.

## Задача

Основная задача проекта — построить модель, которая будет предсказывать рейтинг отеля (reviewer_score) на основе предоставленных данных. В качестве метрики для оценки модели используется **MAPE (Mean Absolute Percentage Error)** — средняя абсолютная процентная ошибка предсказанных значений от фактических.

## Инструменты и библиотеки

В проекте используются следующие инструменты и библиотеки:

- **Python**
- **Pandas**
- **Numpy**
- **Scikit-learn**
- **SciPy**
- **Statsmodels**
- **Matplotlib**
- **Seaborn**
- **Plotly**
- **NLTK**
- **Geopy**

## Основные этапы проекта

1. **Загрузка данных**: Исходные данные загружаются из файла `hotels.csv`.
2. **Очистка данных**:
   - Проверка на пропущенные значения и их заполнение.
   - Заполнение пропущенных значений в координатах отелей с использованием геокодера.
3. **Создание новых признаков**:
   - Извлечение информации из столбца `tags` (тип путешествия, способ бронирования, количество ночей и т.д.).
   - Создание признака страны отеля на основе адреса.
   - Преобразование даты отзыва в признаки (год, месяц, день, сезон, день недели).
   - Кодирование категориальных признаков с использованием `BinaryEncoder`.
4. **Преобразование признаков**:
   - Нормализация и стандартизация числовых признаков.
   - Проверка нормальности распределения признаков.
5. **Отбор признаков**:
   - Удаление признаков с высокой корреляцией (мультиколлинеарностью).
   - Оценка значимости признаков с использованием тестов хи-квадрат и ANOVA.
6. **Создание и обучение модели**:
   - Разделение данных на обучающую и тестовую выборки.
   - Обучение модели `RandomForestRegressor`.
7. **Анализ модели**:
   - Оценка качества модели с использованием метрики MAPE.

## Результаты

Модель была обучена на данных, содержащих информацию об отелях и отзывах. В результате была достигнута метрика **MAPE: 0.12204650015647199**, что указывает на высокую точность предсказаний модели.

## Как использовать проект

1. Установите необходимые зависимости, выполнив команду:
   ```bash
   pip install -r requirements.txt
   ```

2. Запустите Jupyter Notebook и откройте файл `hotels_review_predict.ipynb`.

3. Выполните ячейки по порядку, чтобы воспроизвести процесс анализа данных, создания модели и оценки её качества.
Примерное время выполнения: 12-15 минут получено на датасете 386_000 строк с помощью Intel(R) Core(TM) Ultra 9 185H 32GB RAM.

## Заключение

Проект демонстрирует процесс анализа данных, создания новых признаков, отбора значимых переменных и построения модели машинного обучения для прогнозирования рейтинга отелей. Полученная модель показывает высокую точность и может быть использована для автоматической оценки рейтинга отелей на основе отзывов пользователей.

## Примечание

В проект добавлен файл `hotels_review_predict_kaggle.ipynb` для прогнозирования рейтинга отелей на основе отзывов пользователей на сайте Kaggle. 

Алгоритм проекта включает автоматический отбор признаков с низкой значимостью и мультиколлинеарных признаков. При этом  возможна ручная корректировка результатов этого отбора. Для ручной настройки результата отбора - перейти в ячейку, предшествующую удалению этих признаков из датафрейма и вручную откорректировать соответствующйи список.
Для настройки параметров отбора рекомендуется настроить константы проекта. 

Кроме того, проект включает возможность построения моделей тремя методами (RandomForestRegressor, XGBRegressor, LGBMRegressor) и предсказание с использованием лучшей модели по метрике MAPE.
